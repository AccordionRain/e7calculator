<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>第七史诗计算器</title>
</head>
<style>
    h1 {
        text-align: center;
    }

    h2 {
        text-align: center;
    }

    .防御计算区>div {
        background-color: #f0f0f0;
        /* 背景颜色 */
        border: 2px solid #333;
        /* 边框 */
        border-radius: 10px;
        /* 圆角 */
        padding: 10px;
        /* 内边距 */
        width: 80%;
        /* 宽度 */
        margin: 0 auto;
        /* 水平居中 */
        text-align: center;
        /* 文本居中 */
        box-shadow: 3px 3px 5px #888;
        /* 阴影 */
        font-size: 18px;
        /* 字体大小 */
    }

    .倍率区 .数字标签 {
        display: inline-block;
        text-align: right;
        width: 20%;
    }

    .框选标签 {
        display: inline-block;
        text-align: left;
        width: 30%;
    }
</style>

<body> 
    <a href="index.html">点击前往速度计算器</a>
    <h1>防御计算</h1>
    <div class="防御计算区">
        <h2>我方数据</h2>
        <div class="倍率区">
            <p>倍率区</p>
            <label for="" class="数字标签">攻击力</label>
            <input type="number" class="攻击力"><br>
            <label for="" class="数字标签">攻击力倍率</label>
            <input type="number" class="攻击力倍率" placeholder="省略%"><br>
            <input type="checkbox" class="攻击力提升">
            <label for="" class="框选标签">攻击力提升</label><br>
            <input type="checkbox" class="攻击力大幅提升">
            <label for="" class="框选标签">攻击力大幅提升</label><br>
            <input type="checkbox" class="攻击力降低">
            <label for="" class="框选标签">攻击力降低</label><br>
            <input type="checkbox" class="魄力">
            <label for="" class="框选标签">魄力</label><br>
            <input type="checkbox" class="狂气">
            <label for="" class="框选标签">狂气</label><br><br>

            <label for="" class="数字标签">防御力</label>
            <input type="number" class="防御力"><br>
            <label for="" class="数字标签">防御力倍率</label>
            <input type="number" class="防御力倍率" placeholder="省略%"><br>
            <input type="checkbox" class="防御力提升">
            <label for="" class="框选标签">防御力提升</label><br>
            <input type="checkbox" class="防御力降低">
            <label for="" class="框选标签">防御力降低</label><br>
            <input type="checkbox" class="魄力">
            <label for="" class="框选标签">魄力</label><br><br>


            <label for="" class="数字标签">生命值</label>
            <input type="number" class="生命值"><br>
            <label for="" class="数字标签">生命值倍率</label>
            <input type="number" class="生命值倍率" placeholder="省略%"><br><br>

            <label for="" class="数字标签">速度</label>
            <input type="number" class="速度"><br>
            <label for="" class="数字标签">速度倍率</label>
            <input type="number" class="速度倍率" placeholder="省略%"><br>
            <input type="checkbox" class="速度提升">
            <label for="" class="框选标签">速度提升</label><br>
            <input type="checkbox" class="速度降低">
            <label for="" class="框选标签">速度降低</label><br>
            <input type="checkbox" class="狂气">
            <label for="" class="框选标签">狂气</label><br><br>
        </div>
        <div class="常数区">
            <p>常数区</p>
            <label for="">第七史诗迷之常数</label>
            <label class="常数">1.871</label><br><br>
        </div>
        <div class="技能加成区">
            <p>技能加成区</p>
            <label for="">技能伤害加成</label>
            <input type="number" class="技能伤害加成" placeholder="省略%"><br><br>
        </div>
        <div class="倍率修正区">
            <p>倍率修正区（一般不用动）</p>
            <label for="">倍率修正值</label>
            <input type="number" class="倍率修正值"><br><br>
        </div>
        <div class="属性克制区">
            <p>属性克制区</p>
            <input type="checkbox" class="属性克制">
            <label for="">属性克制</label><br><br>
        </div>
        <div class="增伤区">
            <p>增伤区</p>
            <label for="">伤害量提升</label>
            <input type="number" class="伤害量提升" placeholder="省略%"><br>
            <input type="checkbox" class="愤怒套装">
            <label for="">愤怒套装</label><br>
            <select class="激流套装">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
            <label for="">激流套装</label><br><br>
        </div>
        <div class="易伤区">
            <p>易伤区</p>
            <input type="checkbox" class="标靶">
            <label for="">标靶</label><br><br>
        </div>
        <div class="打击类型区">
            <p>打击类型区</p>
            <select class="伤害类型">
                <option value="普通">普通</option>
                <option value="闪避">闪避</option>
                <option value="强击">强击</option>
                <option value="暴击">暴击</option>
            </select>
            <label for="">伤害</label>
            <input type="number" class="伤害"><br>

            <label for="">暴击伤害</label>
            <input type="number" class="暴击伤害" placeholder="省略%"><br>
            <input type="checkbox" class="暴击伤害提升">
            <label for="" class="框选标签">暴击伤害提升</label><br>
            <input type="checkbox" class="识破">
            <label for="" class="框选标签">识破</label><br><br>
        </div>
        <h2>敌方数据</h2>
        <div class="减伤区">
            <p>减伤区</p>
            <label for="">最大伤害量降低</label>
            <input type="number" class="最大伤害量降低" placeholder="省略%"><br><br>
        </div>
        <div class="分摊区">
            <p>分摊区</p>
            <label for="">最大伤害量分配</label>
            <input type="number" class="最大伤害量分配" placeholder="省略%"><br><br>
        </div>
        <div class="防御区">
            <p>防御区</p>
            <input type="checkbox" class="穿透套装">
            <label for="" class="框选标签">穿透套装</label><br>
            <input type="checkbox" class="防御力提升">
            <label for="" class="框选标签">防御力提升</label><br>
            <input type="checkbox" class="防御力降低">
            <label for="" class="框选标签">防御力降低</label><br>
            <input type="checkbox" class="魄力">
            <label for="" class="框选标签">魄力</label><br><br>
        </div>
        <div class="结果区">
            <p>防御</p>
            <p class="防御"></p>
        </div>
        <div class="后台区" style="display: none;">
            <p>攻击力倍率值</p>
            <p class="攻击力倍率值"></p>
            <p>防御力倍率值</p>
            <p class="防御力倍率值"></p>
            <p>生命值倍率值</p>
            <p class="生命值倍率值"></p>
            <p>速度倍率值</p>
            <p class="速度倍率值"></p>
            <p>总倍率值</p>
            <p class="倍率值"></p>
            <p>常数系数</p>
            <p class="常数系数"></p>
            <p>技能系数</p>
            <p class="技能系数"></p>
            <p>倍率修正系数</p>
            <p class="倍率修正系数"></p>
            <p>属性克制系数</p>
            <p class="属性克制系数"></p>
            <p>增伤系数</p>
            <p class="增伤系数"></p>
            <p>易伤系数</p>
            <p class="易伤系数"></p>
            <p>打击系数</p>
            <p class="打击系数"></p>
            <p>减伤系数</p>
            <p class="减伤系数"></p>
            <p>分摊系数</p>
            <p class="分摊系数"></p>
            <p>防御系数</p>
            <p class="防御系数"></p>
            <p>实际防御</p>
            <p class="实际防御"></p>
        </div>
    </div>

    <script>
        var 倍率区 = document.querySelector(".倍率区")
        var 魄力组 = 倍率区.querySelectorAll('.魄力');
        魄力组.forEach(function (魄力) {
            魄力.addEventListener('change', function () {
                魄力组.forEach(function (魄力1) {
                    魄力1.checked = 魄力.checked;
                });
            });
        });
        var 狂气组 = 倍率区.querySelectorAll('.狂气');
        狂气组.forEach(function (狂气) {
            狂气.addEventListener('change', function () {
                狂气组.forEach(function (狂气1) {
                    狂气1.checked = 狂气.checked;
                });
            });
        });
        var 技能伤害加成框 = document.querySelector(".技能伤害加成")
        技能伤害加成框.addEventListener('input', function () {
            document.querySelector(".倍率修正值").value = parseFloat(1.3 - 技能伤害加成框.value / 100).toFixed(1)
        });

        document.querySelectorAll('input[type="checkbox"],select').forEach(function (e) { e.addEventListener('change', 计算); });
        document.querySelectorAll('input[type="number"]').forEach(function (e) { e.addEventListener('input', 计算); });

        function 计算() {
            let 攻击力 = parseInt(document.querySelector(".攻击力").value) || 0
            let 攻击力倍率 = parseInt(document.querySelector(".攻击力倍率").value) || 0
            let 防御力 = parseInt(document.querySelector(".防御力").value) || 0
            let 防御力倍率 = parseInt(document.querySelector(".防御力倍率").value) || 0
            let 生命值 = parseInt(document.querySelector(".生命值").value) || 0
            let 生命值倍率 = parseInt(document.querySelector(".生命值倍率").value) || 0
            let 速度 = parseInt(document.querySelector(".速度").value) || 0
            let 速度倍率 = parseInt(document.querySelector(".速度倍率").value) || 0
            let 常数 = parseFloat(1.871)
            let 技能伤害加成 = parseInt(document.querySelector(".技能伤害加成").value) || 0

            let 倍率修正值 = parseFloat(document.querySelector(".倍率修正值").value) || 0

            let 伤害量提升 = parseInt(document.querySelector(".伤害量提升").value) || 0
            let 伤害 = parseInt(document.querySelector(".伤害").value) || 0
            let 暴击伤害 = parseInt(document.querySelector(".暴击伤害").value) || 0
            let 最大伤害量降低 = parseInt(document.querySelector(".最大伤害量降低").value) || 0
            let 最大伤害量分配 = parseInt(document.querySelector(".最大伤害量分配").value) || 0

            let 激流套装 = parseInt(document.querySelector(".激流套装").value)
            let 伤害类型 = document.querySelector(".伤害类型").value

            let 攻击力提升 = document.querySelector(".攻击力提升").checked
            let 攻击力大幅提升 = document.querySelector(".攻击力大幅提升").checked
            let 攻击力降低 = document.querySelector(".攻击力降低").checked
            let 魄力 = document.querySelector(".魄力").checked
            let 狂气 = document.querySelector(".狂气").checked
            let 防御力提升 = document.querySelector(".防御力提升").checked
            let 防御力降低 = document.querySelector(".防御力降低").checked
            let 速度提升 = document.querySelector(".速度提升").checked
            let 速度降低 = document.querySelector(".速度降低").checked
            let 属性克制 = document.querySelector(".属性克制").checked
            let 愤怒套装 = document.querySelector(".愤怒套装").checked
            let 标靶 = document.querySelector(".标靶").checked
            let 暴击伤害提升 = document.querySelector(".暴击伤害提升").checked
            let 识破 = document.querySelector(".识破").checked
            let 穿透套装 = document.querySelector(".穿透套装").checked

            let 防御区 = document.querySelector(".防御区")
            let 防御区防御力提升 = 防御区.querySelector(".防御力提升").checked
            let 防御区防御力降低 = 防御区.querySelector(".防御力降低").checked
            let 防御区魄力 = 防御区.querySelector(".魄力").checked



            let 攻击力倍率值 = parseInt(攻击力 * 攻击力倍率 / 100 * (1 + (攻击力提升 ? 0.5 : 0) + (攻击力大幅提升 ? 0.75 : 0) + (攻击力降低 ? -0.5 : 0) + (魄力 ? 0.3 : 0) + (狂气 ? 0.1 : 0)))
            let 防御力倍率值 = parseInt(防御力 * 防御力倍率 / 100 * (1 + (防御力提升 ? 0.6 : 0) + (防御力降低 ? -0.7 : 0) + (魄力 ? 0.3 : 0)))
            let 生命值倍率值 = parseInt(生命值 * 生命值倍率 / 100)
            let 速度倍率值 = parseInt(速度 * 速度倍率 / 100 * (1 + (速度提升 ? 0.3 : 0) + (速度降低 ? -0.3 : 0) + (狂气 ? 0.1 : 0)))
            let 倍率值 = parseInt(攻击力倍率值 + 防御力倍率值 + 生命值倍率值 + 速度倍率值)

            let 常数系数 = 常数

            let 技能系数 = 1 + 技能伤害加成 / 100

            let 倍率修正系数 = 倍率修正值

            let 属性克制系数 = 1 + parseFloat(属性克制 ? 0.1 : 0)

            let 增伤系数 = 1 + 伤害量提升 / 100 + (愤怒套装 ? 0.3 : 0) + 激流套装 * 0.1

            let 易伤系数 = 1 + (标靶 ? 0.15 : 0)

            let 打击系数=0
            if (伤害类型 === "普通") {
                打击系数 = 1
            } else if (伤害类型 === "闪避") {
                打击系数 = 1 - 0.25
            } else if (伤害类型 === "强击") {
                打击系数 = 1 + 0.3
            } else if (伤害类型 === "暴击") {
                let 总暴击伤害 = Math.min(350, parseInt(暴击伤害) + (暴击伤害提升 ? 50 : 0) + (识破 ? 15 : 0))
                打击系数 = 总暴击伤害/100
            }

            let 减伤系数=1-最大伤害量降低/100

            let 分摊系数=1-最大伤害量分配/100


            let 防御系数=伤害 / (倍率值 * 常数系数 * 技能系数*倍率修正系数*属性克制系数*增伤系数*易伤系数*打击系数*减伤系数*分摊系数)

            let 防御减伤 = 1-防御系数
            let 实际防御=parseInt( 300*防御减伤/(1-防御减伤))
            let 防御 =parseInt( 实际防御/((1+(防御区防御力提升 ? 0.6 : 0)+(防御区防御力降低 ? -0.7 : 0)+(防御区魄力 ? 0.3 : 0))*(1+(穿透套装 ? -0.15 : 0))))

            document.querySelector(".攻击力倍率值").textContent = 攻击力倍率值
            document.querySelector(".防御力倍率值").textContent = 防御力倍率值
            document.querySelector(".生命值倍率值").textContent = 生命值倍率值
            document.querySelector(".速度倍率值").textContent = 速度倍率值
            document.querySelector(".倍率值").textContent = 倍率值

            document.querySelector(".常数系数").textContent = 常数系数
            document.querySelector(".技能系数").textContent = 技能系数
            document.querySelector(".倍率修正系数").textContent = 倍率修正系数
            document.querySelector(".属性克制系数").textContent = 属性克制系数
            document.querySelector(".增伤系数").textContent = 增伤系数

            document.querySelector(".易伤系数").textContent = 易伤系数
            document.querySelector(".打击系数").textContent = 打击系数
            document.querySelector(".减伤系数").textContent = 减伤系数
            document.querySelector(".分摊系数").textContent = 分摊系数
            document.querySelector(".防御系数").textContent = 防御系数
            document.querySelector(".实际防御").textContent = 实际防御
            document.querySelector(".防御").textContent = 防御

        }

    </script>
</body>

</html>